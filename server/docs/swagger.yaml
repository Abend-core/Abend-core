openapi: 3.0.0
info:
  title: API Abend-core
    version: 1.0.0
    contact:
        name: Abend-core
        url: http://localhost:5173
tags:
    - name: Auth
      description: Opérations liées à la connexion
    - name: Utilisateurs
      description: Opérations liées aux utilisateurs
    - name: Modules
      description: Opérations liées aux modules

paths:
    auth/signin:
        post:
            tags:
                - Auth
            summary: Inscription à l'application
            requestBody:
                required: true
                content:
                    application/json:
                        schema:
                            type: object
                            required:
                                - mail
                                - password
                            properties:
                                mail:
                                    type: string
                                    description: Mail de l'utilisateur
                                    example: abend-core@gmail.com
                                password:
                                    type: string
                                    description: Mot de passe utilisateur
                                    example: password1
            responses:
                201:
                    description: Connexion réussi
                    content:
                        application/json:
                            schema:
                                type: object
                                items:
                                    type: object
                                    properties:
                                        message:
                                            type: string
                                            example: L'utilisateur a été connecté avec succès.
                                        UUID:
                                            type: string
                                            example: 01949df0-b386-7021-a66e-aea1a8c3ceab
                                        token: 
                                            type: string
                                            example: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1c2VySWQiOiJhcnVkeSIsImlhdCI6MTczMTc4ODY3MywiZXhwIjoxNzMxODc1MDczfQ.AmyzfjxAtcOOAFzWk2RXGjMu2VNWRLetrcjhtamJOU0
                401:
                    description: L'utilisateur a mal renseigner son identifiant.
                    content:
                        application/json:
                            schema:
                                type: object
                                items:
                                    type: object
                                    properties:
                                        message:
                                            type: string
                                            example: Identifiant ou mot de passe incorrect.
                402:
                    description: L'utilisateur a mal renseigner son mot de passe.
                    content:
                        application/json:
                            schema:
                                type: object
                                items:
                                    type: object
                                    properties:
                                        message:
                                            type: string
                                            example: Identifiant ou mot de passe incorrect.
                501:
                    description: Erreur du serveur
                    content:
                        application/json:
                            schema:
                                type: object
                                items:
                                    type: object
                                    properties:
                                        message:
                                            type: string
                                            example: Serveur en maintenance. Réessayez dans quelques instants.
                                        erreur:
                                            type: object
    auth/register:
        post:
            tags:
                - Auth
            summary: S'inscrire sur l'application
            requestBody:
                required: true
                content:
                    application/json:
                        schema:
                            type: object
                            required:
                                - mail
                                - password
                                - identifiant
                            properties:
                                mail:
                                    type: string
                                    description: Mail valide de l'utilisateur
                                    example: abend-core@gmail.com
                                password:
                                    type: string
                                    description: Mot de passe d'au moins 8 caractères
                                    example: password1
                                identifiant:
                                    type: string
                                    example: Abend
            responses:
                201:
                    description: Inscription réussis !
                    content:
                        application/json:
                            schema:
                                type: object
                                items:
                                    type: object
                                    properties:
                                        message:
                                            type: string
                                            example: Utilisateur inscrit avec succès.
                401:
                    description: L'utilisateur c'est trompé dans la saisie.
                    content:
                        application/json:
                            schema:
                                type: object
                                items:
                                    type: object
                                    properties:
                                        errors:
                                            type: object
                501:
                    description: Le serveur ne répond pas.
                    content:
                        application/json:
                            schema:
                                type: object
                                items:
                                    type: object
                                    properties:
                                        message:
                                            type: string
                                            exemple: Erreur serveur.
                                        erreur: 
                                            type: object
    users:
        get:
            tags:
                - Utilisateurs
            summary: Récupérer tout les utilisateurs
            requestBody:
                content:
                    application/json:
            responses:
                201:
                    description: Tout les utilisateurs ont été récupéré.
                    content:
                        application/json:
                            schema:
                                type: object
                                items:
                                    properties:
                                        message:
                                            type: string
                                            example: Tout les utilisateurs.
                                        user: 
                                            type: object
                501:
                    description: Le serveur ne répond pas.
                    content:
                        application/json:
                            schema:
                                type: object
                                items:
                                    type: object
                                    properties:
                                        message:
                                            type: string
                                            exemple: Erreur serveur.
                                        erreur: 
                                            type: object
    users/:id:
        get:
            tags:
                - Utilisateurs
            summary: Récupérer tout les utilisateurs
            parameters:
            - name: id
              in: path
              description: L'identifiant de l'utilisateur à récupérer
              required: true
              schema:
                  type: string
                  exemple: 01949df0-b386-7021-a66e-aea1a8c3ceab
            responses:
                201:
                    description: Utilisateur récupéré.
                    content:
                        application/json:
                            schema:
                                type: object
                                items:
                                    properties:
                                        message:
                                            type: string
                                            example: Utilisateur trouvé.
                                        user: 
                                            type: object
                404:
                    description: Utilisateur récupéré.
                    content:
                        application/json:
                            schema:
                                type: object
                                items:
                                    properties:
                                        message:
                                            type: string
                                            example: Utilisateur introuvable.
                501:
                    description: Le serveur ne répond pas.
                    content:
                        application/json:
                            schema:
                                type: object
                                items:
                                    type: object
                                    properties:
                                        message:
                                            type: string
                                            exemple: Erreur serveur.
                                        erreur: 
                                            type: object
    users/add:
        post:
            tags:
                - Utilisateurs
            summary: Ajouter un utilisateur
            requestBody:
                required: true
                content:
                    application/json:
                        schema:
                            type: object
                            required:
                                - mail
                                - identifiant
                                - isAdmin
                            properties:
                                mail:
                                    type: string
                                    description: Mail valide de l'utilisateur
                                    example: abend-core@gmail.com
                                identifiant:
                                    type: string
                                    description: Nom de l'utilisateur
                                    example: Abend
                                isAdmin:
                                    type: boolean
                                    example: true
            responses:
                201:
                    description: L'utilisateur a été ajouter.
                    content:
                        application/json:
                            schema:
                                type: object
                                items:
                                    properties:
                                        message:
                                            type: string
                                            example: Utilisateur créé avec succès.
                                        user: 
                                            type: object
                401:
                    description: Champs mal renseignés.
                    content:
                        application/json:
                            schema:
                                type: object
                                items:
                                    type: object
                                    properties:
                                        message:
                                            type: string
                                            exemple: Le mail doit être unique.
                                        erreur: 
                                            type: object                            
                501:
                    description: Le serveur ne répond pas.
                    content:
                        application/json:
                            schema:
                                type: object
                                items:
                                    type: object
                                    properties:
                                        message:
                                            type: string
                                            exemple: Erreur serveur.
                                        erreur: 
                                            type: object
    users/update/:id:
        post:
            tags:
                - Utilisateurs
            summary: Modifier un utilisateur
            requestBody:
                content:
                    application/json:
                        schema:
                            type: object
                            required:
                                - mail
                                - identifiant
                                - isAdmin
                            properties:
                                mail:
                                    type: string
                                    description: Mail valide de l'utilisateur
                                    example: abend-core@gmail.com
                                identifiant:
                                    type: string
                                    description: Nom de l'utilisateur
                                    example: Abend
                                isAdmin:
                                    type: boolean
                                    example: true
            parameters:
            - name: id
              in: path
              description: L'identifiant de l'utilisateur à modifier
              required: true
              schema:
                  type: string
                  exemple: 01949df0-b386-7021-a66e-aea1a8c3ceab
            responses:
                201:
                    description: L'utilisateur a été modifié.
                    content:
                        application/json:
                            schema:
                                type: object
                                items:
                                    properties:
                                        message:
                                            type: string
                                            example: Utilisateur modifié avec succès.
                                        user: 
                                            type: object
                404:
                    description: L'utilisateur n'existe pas.
                    content:
                        application/json:
                            schema:
                                type: object
                                items:
                                    type: object
                                    properties:
                                        message:
                                            type: string
                                            exemple: Utilisateur introuvable.                          
                501:
                    description: Le serveur ne répond pas.
                    content:
                        application/json:
                            schema:
                                type: object
                                items:
                                    type: object
                                    properties:
                                        message:
                                            type: string
                                            exemple: Erreur serveur.
                                        erreur: 
                                            type: object
    users/delete/:id:
        post:
            tags:
                - Utilisateurs
            summary: Supprimer un utilisateur
            parameters:
            - name: id
              in: path
              description: L'identifiant de l'utilisateur à supprimer
              required: true
              schema:
                  type: string
                  exemple: 01949df0-b386-7021-a66e-aea1a8c3ceab
            responses:
                201:
                    description: L'utilisateur a été supprimé.
                    content:
                        application/json:
                            schema:
                                type: object
                                items:
                                    properties:
                                        message:
                                            type: string
                                            example: Utilisateur supprimé avec succès.
                                        user: 
                                            type: object
                404:
                    description: L'utilisateur n'existe pas.
                    content:
                        application/json:
                            schema:
                                type: object
                                items:
                                    type: object
                                    properties:
                                        message:
                                            type: string
                                            exemple: Utilisateur introuvable.                          
                501:
                    description: Le serveur ne répond pas.
                    content:
                        application/json:
                            schema:
                                type: object
                                items:
                                    type: object
                                    properties:
                                        message:
                                            type: string
                                            exemple: Erreur serveur.
                                        erreur: 
                                            type: object
                502:
                    description: Erreur lors de la suppression du fichier.
                    content:
                        application/json:
                            schema:
                                type: object
                                items:
                                    type: object
                                    properties:
                                        message:
                                            type: string
                                            exemple: Erreur lors de la suppression de l'image de l'utilisateur.
                                        erreur: 
                                            type: object
                503:
                    description: Le serveur ne répond pas.
                    content:
                        application/json:
                            schema:
                                type: object
                                items:
                                    type: object
                                    properties:
                                        message:
                                            type: string
                                            exemple: Erreur lors de la suppression de l'image du/des modules.
                                        erreur: 
                                            type: object
    users/filtre:
        post:
            tags:
                - Utilisateurs
            summary: Filtrer les données utilisateur
            requestBody:
                required: true
                content:
                    application/json:
                        schema:
                            type: object
                            required:
                                - search
                            properties:
                                search:
                                    type: string
                                    description: Valeur qui va filtrer la colonne username et mail d'un utilisateur
            responses:
                201:
                    description: Filtre réussis.
                    content:
                        application/json:
                            schema:
                                type: object
                                items:
                                    properties:
                                        message:
                                            type: string
                                            example: Utilisateur trouvé.
                                        user: 
                                            type: object         
                501:
                    description: Le serveur ne répond pas.
                    content:
                        application/json:
                            schema:
                                type: object
                                items:
                                    type: object
                                    properties:
                                        message:
                                            type: string
                                            exemple: Erreur serveur.
                                        erreur: 
                                            type: object
    users/updateImg:
        post:
            tags:
                - Utilisateurs
            summary: Modifier l'image de l'utilisateur
            requestBody:
                required: true
                content:
                    application/json:
                        schema:
                            type: object
                            required:
                                - id
                                - image
                            properties:
                                id:
                                    type: string
                                    description: 0194a43e-8212-7107-806a-9e224db48a0d
            responses:
                201:
                    description: L'image est bien redimensionné.
                    content:
                        application/json:
                            schema:
                                type: object
                                items:
                                    properties:
                                        message:
                                            type: string
                                            example: Image téléchargée et redimensionné avec succès.
                                        file: 
                                            type: object
                                            example: path & name
                401:
                    description: Erreur de téléchargement.
                    content:
                        application/json:
                            schema:
                                type: object
                                items:
                                    type: object
                                    properties:
                                        message:
                                            type: string
                                            exemple: Aucun fichier n'a été téléchargé. 
                501:
                    description: Erreur serveur.
                    content:
                        application/json:
                            schema:
                                type: object
                                items:
                                    type: object
                                    properties:
                                        message:
                                            type: string
                                            exemple: Erreur serveur.
                502:
                    description: Erreur lors de l'upload de l'image.
                    content:
                        application/json:
                            schema:
                                type: object
                                items:
                                    type: object
                                    properties:
                                        message:
                                            type: string
                                            exemple: Erreur lors de l'upload de l'image.
                                        erreur: 
                                            type: object
                503:
                    description: Probleme de redimensionnement
                    content:
                        application/json:
                            schema:
                                type: object
                                items:
                                    type: object
                                    properties:
                                        message:
                                            type: string
                                            exemple: Erreur lors du redimensionnement de l'image.
                                        erreur: 
                                            type: object
                504:
                    description: Erreur lors de la suppression du fichier.
                    content:
                        application/json:
                            schema:
                                type: object
                                items:
                                    type: object
                                    properties:
                                        message:
                                            type: string
                                            exemple: Erreur lors de la suppression de l'image.
                                        erreur: 
                                            type: object
                505:
                    description: Erreur inattendue lors du redimensionnement de l'image.
                    content:
                        application/json:
                            schema:
                                type: object
                                items:
                                    type: object
                                    properties:
                                        message:
                                            type: string
                                            exemple: Erreur inattendue lors du redimensionnement de l'image.
                                        erreur: 
                                            type: object
    users/password:
        post:
            tags:
                - Utilisateurs
            summary: Modification du mot de passe utilisateur
            requestBody:
                required: true
                content:
                    application/json:
                        schema:
                            type: object
                            required:
                                - password
                                - newPassword
                                - confirmPassword
                            properties:
                                password:
                                    type: string
                                    description: password2
                                newPassword:
                                    type: string
                                    description: password1
                                confirmPassword:
                                    type: string
                                    description: password1
            responses:
                201:
                    description: Mot de passe modifié avec succès
                    content:
                        application/json:
                            schema:
                                type: object
                                items:
                                    properties:
                                        message:
                                            type: string
                                            example: Image téléchargée et redimensionné avec succès.
                                        file: 
                                            type: object
                                            example: {
                                                path: src/uploads/profil/0194a43e-822c-741a-b121-ac87228f3817.png,
                                                name: 0194a43e-822c-741a-b121-ac87228f3817.png
                                            }     
                401:
                    description: Mot de passe incorrect.
                    content:
                        application/json:
                            schema:
                                type: object
                                items:
                                    type: object
                                    properties:
                                        message:
                                            type: string
                                            exemple: Mot de passe incorrect.
                402:
                    description: Mot de passe trop court.
                    content:
                        application/json:
                            schema:
                                type: object
                                items:
                                    type: object
                                    properties:
                                        message:
                                            type: string
                                            exemple: Le mot de passe doit avoir au moins 8 caractères.
                403:
                    description: Les mots de passe pas identique
                    content:
                        application/json:
                            schema:
                                type: object
                                items:
                                    type: object
                                    properties:
                                        message:
                                            type: string
                                            exemple: Les mots de passe ne correspondent pas.
                501:
                    description: Erreur serveur.
                    content:
                        application/json:
                            schema:
                                type: object
                                items:
                                    type: object
                                    properties:
                                        message:
                                            type: string
                                            exemple: Erreur serveur.
                